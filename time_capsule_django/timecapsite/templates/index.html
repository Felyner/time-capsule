{% load staticfiles %}
<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
		<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/themes/smoothness/jquery-ui.css" />
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/jquery-ui.min.js"></script>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
		<link href='http://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>

		<style>
			html {
				background-image: #FFFFFF;
				font-family: 'Raleway', sans-serif;
			}

			#welcome {
				
			}

		</style>
		<script>
			$(document).ready(function() {
				var fileCount = 1
				$("#addAssets").click(function(){
					fileCount ++
					$("#timeCapAssetNew").attr('name', 'timeCapAsset_' + fileCount)
					newInput = $("#assetAdder").html()
					$("#assetInputs").append(newInput)
					$("#assetInputs #timeCapAssetNew").attr('id', 'timeCapAsset_' + fileCount)
				})
				$("#newCap").click(function(){
					$("#timecapsule").toggle()
					$("#tsUnlock").datepicker({
						dateFormat: 'yy-mm-dd'
					})
				})
			})
		</script>
	</head>
	<body>
		<div id="welcome">
			<h2>Time Capsule</h2><br/>
			<div>
				{% if user.is_authenticated %}
				Welcome {{user}}!
				<a href="/logout">Logout</a>
				<br/><br/>
				<button id="newCap">Create new TimeCapsule</button><br/><br/>
				<form id="timecapsule" enctype="multipart/form-data" action="/createCapsule/" method="post" style="display:none">
					{% csrf_token %}
					Unlock date: <input id="tsUnlock" name="tsUnlock" style="float:right"/><br/><br />
					<span id="assetInputs">Add asset: <input type="file" id="timeCapAsset_1" name="timeCapAsset_1" size="40" style="float:right"/><br/><br/></span>
					<button id="addAssets" type="button">Add another asset</button>
					<button name="Submit" type="submit" id="submit" name="submit" value="createNewCap">Submit</button>

				</form>
			</div>
			{%else%}
				<a href="/login">Login</a> or <a href="/register">Register</a>
			{%endif%}
		</div>
		{% if user.is_authenticated %}
		<div id="lockedTimeCaps">
			<br/><br/><b>Locked Time Capsules</b><br/><br/>
			{%for cap in userCapsLocked%}
			You created a time capsule on {{cap.tsCreated}} that will unlock on {{cap.tsUnlock}}<br/><br/>
			{%endfor%}
		</div>
		<div id="unlockedTimeCaps">
			<br/><br/><b>Unlocked Time Capsules</b><br/><br/>
			{%for cap in userCapsUnlocked%}
			A time capsule from back on {{cap.tsCreated}} has been unearthed! Here are the contents:<br/>
			{%for tcAsset in tcAssets%}
			{%if tcAsset.parentID == cap%}
			<a href="media/{{tcAsset.asset}}">{{tcAsset.asset}}</a><br/>
			{%endif%}
			{%endfor%}
			<br/>
			{%endfor%}
		</div>
		{%endif%}
		<div id="assetAdder" style="display:none">
			Add asset: <input type="file" id="timeCapAssetNew" name="timeCapAssetNew" size="40" style="float:right"/><br/><br/>
		</div>
	</body>
	<footer>
	</footer>
</html>